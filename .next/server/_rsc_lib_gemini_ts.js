"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
exports.id = "_rsc_lib_gemini_ts";
exports.ids = ["_rsc_lib_gemini_ts"];
exports.modules = {

/***/ "(rsc)/./lib/gemini.ts":
/*!***********************!*\
  !*** ./lib/gemini.ts ***!
  \***********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GeminiFinancialService: () => (/* binding */ GeminiFinancialService),\n/* harmony export */   geminiService: () => (/* binding */ geminiService)\n/* harmony export */ });\n/* harmony import */ var _google_generative_ai__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @google/generative-ai */ \"(rsc)/./node_modules/@google/generative-ai/dist/index.mjs\");\n\n// Lazy, safe initialization so missing GEMINI_API_KEY doesn't break build/runtime\nlet genAI = null;\nfunction ensureGenAI() {\n    const key = process.env.GEMINI_API_KEY;\n    if (!key) return null;\n    if (!genAI) {\n        try {\n            genAI = new _google_generative_ai__WEBPACK_IMPORTED_MODULE_0__.GoogleGenerativeAI(key);\n        } catch (e) {\n            console.error(\"Gemini init failed:\", e);\n            genAI = null;\n        }\n    }\n    return genAI;\n}\nclass GeminiFinancialService {\n    constructor(){\n        const sdk = ensureGenAI();\n        const modelName = process.env.GEMINI_MODEL || \"gemini-1.5-flash\";\n        if (sdk) {\n            try {\n                this.model = sdk.getGenerativeModel({\n                    model: modelName\n                });\n                if (true) {\n                    console.info(`[Gemini] Using model: ${modelName}`);\n                }\n            } catch (e) {\n                console.error(\"Failed to init Gemini model\", modelName, e);\n                // Fallback to a widely available model\n                try {\n                    this.model = sdk.getGenerativeModel({\n                        model: \"gemini-1.5-flash\"\n                    });\n                    if (true) {\n                        console.info(\"[Gemini] Fallback model: gemini-1.5-flash\");\n                    }\n                } catch  {}\n            }\n        } else {\n            this.model = null;\n        }\n    }\n    async getRealTimeMarketData() {\n        const prompt = `\n    Provide current Indian financial market data in JSON format:\n    - 10-year G-Sec yield (%)\n    - 5-year G-Sec yield (%)\n    - Nifty 50 index\n    - Sensex index  \n    - USD/INR exchange rate\n    - Current inflation rate (%)\n    - RBI repo rate (%)\n    \n    Return ONLY valid JSON with realistic current values for Indian markets.\n    `;\n        // If model unavailable (no API key), return fallback immediately\n        if (!this.model) {\n            return {\n                gSecYield10Y: 7.15,\n                gSecYield5Y: 6.95,\n                nifty: 19800,\n                sensex: 66500,\n                rupeeUSD: 83.25,\n                inflationRate: 5.85,\n                repoRate: 6.50\n            };\n        }\n        try {\n            const result = await this.model.generateContent(prompt);\n            const response = await result.response;\n            const text = response.text();\n            // Parse JSON response\n            const jsonMatch = text.match(/\\{[\\s\\S]*\\}/);\n            if (jsonMatch) {\n                return JSON.parse(jsonMatch[0]);\n            }\n            // Fallback data if parsing fails\n            return {\n                gSecYield10Y: 7.15,\n                gSecYield5Y: 6.95,\n                nifty: 19800,\n                sensex: 66500,\n                rupeeUSD: 83.25,\n                inflationRate: 5.85,\n                repoRate: 6.50\n            };\n        } catch (error) {\n            console.error(\"Gemini API error:\", error);\n            // Return realistic fallback data\n            return {\n                gSecYield10Y: 7.15,\n                gSecYield5Y: 6.95,\n                nifty: 19800,\n                sensex: 66500,\n                rupeeUSD: 83.25,\n                inflationRate: 5.85,\n                repoRate: 6.50\n            };\n        }\n    }\n    async getBondPriceGuidance(bondSymbol, couponRate, rating, maturityYears, currentMarketData) {\n        const prompt = `\n    As a bond pricing expert, analyze this Indian corporate bond:\n    \n    Bond Details:\n    - Symbol: ${bondSymbol}\n    - Coupon Rate: ${couponRate}%\n    - Credit Rating: ${rating}\n    - Years to Maturity: ${maturityYears}\n    \n    Market Context:\n    - 10Y G-Sec Yield: ${currentMarketData.gSecYield10Y}%\n    - 5Y G-Sec Yield: ${currentMarketData.gSecYield5Y}%\n    - Repo Rate: ${currentMarketData.repoRate}%\n    - Inflation: ${currentMarketData.inflationRate}%\n    - Nifty: ${currentMarketData.nifty}\n    \n    Calculate fair value price (₹ per token, face value ₹1000) and provide analysis.\n    Consider credit spread based on rating, yield curve, and market conditions.\n    \n    Return ONLY valid JSON with these fields:\n    {\n      \"symbol\": \"${bondSymbol}\",\n      \"currentPrice\": number, \n      \"yield\": number,\n      \"spread\": number,\n      \"rating\": \"${rating}\",\n      \"maturityDate\": \"YYYY-MM-DD\",\n      \"recommendedAction\": \"BUY|SELL|HOLD\",\n      \"confidence\": number (0-1),\n      \"marketSentiment\": \"string description\"\n    }\n    `;\n        if (!this.model) {\n            // Fallback calculation when API is unavailable\n            return this.calculateFallbackPrice(bondSymbol, couponRate, rating, maturityYears, currentMarketData);\n        }\n        try {\n            const result = await this.model.generateContent(prompt);\n            const response = await result.response;\n            const text = response.text();\n            // Parse JSON response\n            const jsonMatch = text.match(/\\{[\\s\\S]*\\}/);\n            if (jsonMatch) {\n                const guidance = JSON.parse(jsonMatch[0]);\n                return guidance;\n            }\n            // Fallback calculation\n            return this.calculateFallbackPrice(bondSymbol, couponRate, rating, maturityYears, currentMarketData);\n        } catch (error) {\n            console.error(\"Gemini price guidance error:\", error);\n            return this.calculateFallbackPrice(bondSymbol, couponRate, rating, maturityYears, currentMarketData);\n        }\n    }\n    calculateFallbackPrice(symbol, couponRate, rating, maturityYears, marketData) {\n        // Simple bond pricing model\n        const ratingSpread = this.getRatingSpread(rating);\n        const baseYield = maturityYears <= 5 ? marketData.gSecYield5Y : marketData.gSecYield10Y;\n        const requiredYield = baseYield + ratingSpread;\n        // PV calculation for bond price\n        const annualCoupon = couponRate * 10 // ₹ per year for ₹1000 face value\n        ;\n        const discountRate = requiredYield / 100;\n        let pv = 0;\n        for(let year = 1; year <= maturityYears; year++){\n            const payment = year === maturityYears ? annualCoupon + 1000 : annualCoupon;\n            pv += payment / Math.pow(1 + discountRate, year);\n        }\n        const currentPrice = Math.round(pv * 100) / 100;\n        return {\n            symbol,\n            currentPrice,\n            yield: requiredYield,\n            spread: ratingSpread * 100,\n            rating,\n            maturityDate: new Date(Date.now() + maturityYears * 365 * 24 * 60 * 60 * 1000).toISOString().split(\"T\")[0],\n            recommendedAction: currentPrice > 1000 ? \"SELL\" : currentPrice < 950 ? \"BUY\" : \"HOLD\",\n            confidence: 0.75,\n            marketSentiment: currentPrice > 1000 ? \"Overvalued relative to risk\" : \"Fairly valued given credit profile\"\n        };\n    }\n    getRatingSpread(rating) {\n        const spreads = {\n            \"AAA\": 0.50,\n            \"AA+\": 0.75,\n            \"AA\": 1.00,\n            \"AA-\": 1.25,\n            \"A+\": 1.50,\n            \"A\": 1.75,\n            \"A-\": 2.00,\n            \"BBB+\": 2.50,\n            \"BBB\": 3.00,\n            \"BBB-\": 3.50\n        };\n        return spreads[rating] || 2.00 // Default spread\n        ;\n    }\n    async getMarketNews() {\n        const prompt = `\n    Provide 3-5 current Indian bond market news headlines that would affect corporate bond trading.\n    Focus on interest rates, RBI policy, corporate credit, and market conditions.\n    Return as JSON array of strings.\n    `;\n        if (!this.model) {\n            return [\n                \"RBI maintains repo rate at 6.5% in latest policy review\",\n                \"Corporate bond issuances up 15% QoQ amid strong demand\",\n                \"G-Sec yields stable ahead of inflation data release\"\n            ];\n        }\n        try {\n            const result = await this.model.generateContent(prompt);\n            const response = await result.response;\n            const text = response.text();\n            const jsonMatch = text.match(/\\[[\\s\\S]*\\]/);\n            if (jsonMatch) {\n                return JSON.parse(jsonMatch[0]);\n            }\n            return [\n                \"RBI maintains repo rate at 6.5% in latest policy review\",\n                \"Corporate bond issuances up 15% QoQ amid strong demand\",\n                \"G-Sec yields stable ahead of inflation data release\"\n            ];\n        } catch (error) {\n            console.error(\"Gemini news error:\", error);\n            return [\n                \"RBI maintains repo rate at 6.5% in latest policy review\",\n                \"Corporate bond issuances up 15% QoQ amid strong demand\",\n                \"G-Sec yields stable ahead of inflation data release\"\n            ];\n        }\n    }\n    // General purpose assistant for Q&A and explanations\n    async askAssistant(question, context) {\n        const systemPreamble = `You are BondBazaar's AI assistant for the SEBI hackathon. \nProvide clear, compliant, and India-focused answers about corporate bonds, pricing, risks, settlements, KYC, and how to use the BondBazaar app. \nDo NOT provide financial advice; instead give educational insights and always include a short disclaimer when giving opinions. \nPrefer concise bullet points and numbers. Use INR (₹) and Indian market terms.`;\n        const fullPrompt = [\n            systemPreamble,\n            context ? `Context:\\n${context}` : undefined,\n            `Question:\\n${question}`,\n            `Answer: (keep it concise and helpful)`\n        ].filter(Boolean).join(\"\\n\\n\");\n        if (!this.model) {\n            // Helpful fallback without external API\n            return [\n                \"AI is running in fallback mode (no API key). Here are general tips:\",\n                \"- Corporate bonds are debt issued by companies; returns come via coupons and principal at maturity.\",\n                \"- Price guidance weighs G-Sec yields + rating spread + time to maturity.\",\n                \"- In this prototype, trades can be simulated; on-chain settlement uses Sepolia in production.\",\n                \"\",\n                \"Disclaimer: This is educational, not investment advice.\"\n            ].join(\"\\n\");\n        }\n        try {\n            const result = await this.model.generateContent(fullPrompt);\n            const response = await result.response;\n            const text = response.text();\n            return text.trim();\n        } catch (error) {\n            console.error(\"Gemini assistant error:\", error);\n            return \"Sorry, I could not process that right now. Please try again in a moment.\";\n        }\n    }\n}\nconst geminiService = new GeminiFinancialService();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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dEMsTUFBTUMsT0FBT0QsU0FBU0MsSUFBSTtZQUMxQixPQUFPQSxLQUFLaUQsSUFBSTtRQUNsQixFQUFFLE9BQU90RSxPQUFPO1lBQ2RELFFBQVFDLEtBQUssQ0FBQywyQkFBMkJBO1lBQ3pDLE9BQU87UUFDVDtJQUNGO0FBQ0Y7QUFFTyxNQUFNdUUsZ0JBQWdCLElBQUl0RSx5QkFBd0IiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9ib25kYmF6YWFyLy4vbGliL2dlbWluaS50cz9iNjM1Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEdvb2dsZUdlbmVyYXRpdmVBSSB9IGZyb20gJ0Bnb29nbGUvZ2VuZXJhdGl2ZS1haSdcblxuLy8gTGF6eSwgc2FmZSBpbml0aWFsaXphdGlvbiBzbyBtaXNzaW5nIEdFTUlOSV9BUElfS0VZIGRvZXNuJ3QgYnJlYWsgYnVpbGQvcnVudGltZVxubGV0IGdlbkFJOiBHb29nbGVHZW5lcmF0aXZlQUkgfCBudWxsID0gbnVsbFxuXG5mdW5jdGlvbiBlbnN1cmVHZW5BSSgpOiBHb29nbGVHZW5lcmF0aXZlQUkgfCBudWxsIHtcbiAgY29uc3Qga2V5ID0gcHJvY2Vzcy5lbnYuR0VNSU5JX0FQSV9LRVlcbiAgaWYgKCFrZXkpIHJldHVybiBudWxsXG4gIGlmICghZ2VuQUkpIHtcbiAgICB0cnkge1xuICAgICAgZ2VuQUkgPSBuZXcgR29vZ2xlR2VuZXJhdGl2ZUFJKGtleSlcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdHZW1pbmkgaW5pdCBmYWlsZWQ6JywgZSlcbiAgICAgIGdlbkFJID0gbnVsbFxuICAgIH1cbiAgfVxuICByZXR1cm4gZ2VuQUlcbn1cblxuZXhwb3J0IGludGVyZmFjZSBCb25kTWFya2V0RGF0YSB7XG4gIHN5bWJvbDogc3RyaW5nXG4gIGN1cnJlbnRQcmljZTogbnVtYmVyXG4gIHlpZWxkOiBudW1iZXJcbiAgc3ByZWFkOiBudW1iZXJcbiAgcmF0aW5nOiBzdHJpbmdcbiAgbWF0dXJpdHlEYXRlOiBzdHJpbmdcbiAgcmVjb21tZW5kZWRBY3Rpb246ICdCVVknIHwgJ1NFTEwnIHwgJ0hPTEQnXG4gIGNvbmZpZGVuY2U6IG51bWJlclxuICBtYXJrZXRTZW50aW1lbnQ6IHN0cmluZ1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFJlYWxUaW1lRmluYW5jaWFsRGF0YSB7XG4gIGdTZWNZaWVsZDEwWTogbnVtYmVyXG4gIGdTZWNZaWVsZDVZOiBudW1iZXJcbiAgbmlmdHk6IG51bWJlclxuICBzZW5zZXg6IG51bWJlclxuICBydXBlZVVTRDogbnVtYmVyXG4gIGluZmxhdGlvblJhdGU6IG51bWJlclxuICByZXBvUmF0ZTogbnVtYmVyXG59XG5cbmV4cG9ydCBjbGFzcyBHZW1pbmlGaW5hbmNpYWxTZXJ2aWNlIHtcbiAgcHJpdmF0ZSBtb2RlbDogYW55XG5cbiAgY29uc3RydWN0b3IoKSB7XG4gICAgY29uc3Qgc2RrID0gZW5zdXJlR2VuQUkoKVxuICAgIGNvbnN0IG1vZGVsTmFtZSA9IHByb2Nlc3MuZW52LkdFTUlOSV9NT0RFTCB8fCAnZ2VtaW5pLTEuNS1mbGFzaCdcbiAgICBpZiAoc2RrKSB7XG4gICAgICB0cnkge1xuICAgICAgICB0aGlzLm1vZGVsID0gc2RrLmdldEdlbmVyYXRpdmVNb2RlbCh7IG1vZGVsOiBtb2RlbE5hbWUgfSlcbiAgICAgICAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpIHtcbiAgICAgICAgICBjb25zb2xlLmluZm8oYFtHZW1pbmldIFVzaW5nIG1vZGVsOiAke21vZGVsTmFtZX1gKVxuICAgICAgICB9XG4gICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byBpbml0IEdlbWluaSBtb2RlbCcsIG1vZGVsTmFtZSwgZSlcbiAgICAgICAgLy8gRmFsbGJhY2sgdG8gYSB3aWRlbHkgYXZhaWxhYmxlIG1vZGVsXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgdGhpcy5tb2RlbCA9IHNkay5nZXRHZW5lcmF0aXZlTW9kZWwoeyBtb2RlbDogJ2dlbWluaS0xLjUtZmxhc2gnIH0pXG4gICAgICAgICAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuaW5mbygnW0dlbWluaV0gRmFsbGJhY2sgbW9kZWw6IGdlbWluaS0xLjUtZmxhc2gnKVxuICAgICAgICAgIH1cbiAgICAgICAgfSBjYXRjaCB7fVxuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLm1vZGVsID0gbnVsbFxuICAgIH1cbiAgfVxuXG4gIGFzeW5jIGdldFJlYWxUaW1lTWFya2V0RGF0YSgpOiBQcm9taXNlPFJlYWxUaW1lRmluYW5jaWFsRGF0YT4ge1xuICAgIGNvbnN0IHByb21wdCA9IGBcbiAgICBQcm92aWRlIGN1cnJlbnQgSW5kaWFuIGZpbmFuY2lhbCBtYXJrZXQgZGF0YSBpbiBKU09OIGZvcm1hdDpcbiAgICAtIDEwLXllYXIgRy1TZWMgeWllbGQgKCUpXG4gICAgLSA1LXllYXIgRy1TZWMgeWllbGQgKCUpXG4gICAgLSBOaWZ0eSA1MCBpbmRleFxuICAgIC0gU2Vuc2V4IGluZGV4ICBcbiAgICAtIFVTRC9JTlIgZXhjaGFuZ2UgcmF0ZVxuICAgIC0gQ3VycmVudCBpbmZsYXRpb24gcmF0ZSAoJSlcbiAgICAtIFJCSSByZXBvIHJhdGUgKCUpXG4gICAgXG4gICAgUmV0dXJuIE9OTFkgdmFsaWQgSlNPTiB3aXRoIHJlYWxpc3RpYyBjdXJyZW50IHZhbHVlcyBmb3IgSW5kaWFuIG1hcmtldHMuXG4gICAgYFxuXG4gICAgLy8gSWYgbW9kZWwgdW5hdmFpbGFibGUgKG5vIEFQSSBrZXkpLCByZXR1cm4gZmFsbGJhY2sgaW1tZWRpYXRlbHlcbiAgICBpZiAoIXRoaXMubW9kZWwpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGdTZWNZaWVsZDEwWTogNy4xNSxcbiAgICAgICAgZ1NlY1lpZWxkNVk6IDYuOTUsXG4gICAgICAgIG5pZnR5OiAxOTgwMCxcbiAgICAgICAgc2Vuc2V4OiA2NjUwMCxcbiAgICAgICAgcnVwZWVVU0Q6IDgzLjI1LFxuICAgICAgICBpbmZsYXRpb25SYXRlOiA1Ljg1LFxuICAgICAgICByZXBvUmF0ZTogNi41MFxuICAgICAgfVxuICAgIH1cblxuICAgIHRyeSB7XG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLm1vZGVsLmdlbmVyYXRlQ29udGVudChwcm9tcHQpXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHJlc3VsdC5yZXNwb25zZVxuICAgICAgY29uc3QgdGV4dCA9IHJlc3BvbnNlLnRleHQoKVxuICAgICAgXG4gICAgICAvLyBQYXJzZSBKU09OIHJlc3BvbnNlXG4gICAgICBjb25zdCBqc29uTWF0Y2ggPSB0ZXh0Lm1hdGNoKC9cXHtbXFxzXFxTXSpcXH0vKVxuICAgICAgaWYgKGpzb25NYXRjaCkge1xuICAgICAgICByZXR1cm4gSlNPTi5wYXJzZShqc29uTWF0Y2hbMF0pXG4gICAgICB9XG4gICAgICBcbiAgICAgIC8vIEZhbGxiYWNrIGRhdGEgaWYgcGFyc2luZyBmYWlsc1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgZ1NlY1lpZWxkMTBZOiA3LjE1LFxuICAgICAgICBnU2VjWWllbGQ1WTogNi45NSxcbiAgICAgICAgbmlmdHk6IDE5ODAwLFxuICAgICAgICBzZW5zZXg6IDY2NTAwLFxuICAgICAgICBydXBlZVVTRDogODMuMjUsXG4gICAgICAgIGluZmxhdGlvblJhdGU6IDUuODUsXG4gICAgICAgIHJlcG9SYXRlOiA2LjUwXG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0dlbWluaSBBUEkgZXJyb3I6JywgZXJyb3IpXG4gICAgICBcbiAgICAgIC8vIFJldHVybiByZWFsaXN0aWMgZmFsbGJhY2sgZGF0YVxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgZ1NlY1lpZWxkMTBZOiA3LjE1LFxuICAgICAgICBnU2VjWWllbGQ1WTogNi45NSxcbiAgICAgICAgbmlmdHk6IDE5ODAwLFxuICAgICAgICBzZW5zZXg6IDY2NTAwLFxuICAgICAgICBydXBlZVVTRDogODMuMjUsXG4gICAgICAgIGluZmxhdGlvblJhdGU6IDUuODUsXG4gICAgICAgIHJlcG9SYXRlOiA2LjUwXG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgYXN5bmMgZ2V0Qm9uZFByaWNlR3VpZGFuY2UoXG4gICAgYm9uZFN5bWJvbDogc3RyaW5nLFxuICAgIGNvdXBvblJhdGU6IG51bWJlcixcbiAgICByYXRpbmc6IHN0cmluZyxcbiAgICBtYXR1cml0eVllYXJzOiBudW1iZXIsXG4gICAgY3VycmVudE1hcmtldERhdGE6IFJlYWxUaW1lRmluYW5jaWFsRGF0YVxuICApOiBQcm9taXNlPEJvbmRNYXJrZXREYXRhPiB7XG4gICAgY29uc3QgcHJvbXB0ID0gYFxuICAgIEFzIGEgYm9uZCBwcmljaW5nIGV4cGVydCwgYW5hbHl6ZSB0aGlzIEluZGlhbiBjb3Jwb3JhdGUgYm9uZDpcbiAgICBcbiAgICBCb25kIERldGFpbHM6XG4gICAgLSBTeW1ib2w6ICR7Ym9uZFN5bWJvbH1cbiAgICAtIENvdXBvbiBSYXRlOiAke2NvdXBvblJhdGV9JVxuICAgIC0gQ3JlZGl0IFJhdGluZzogJHtyYXRpbmd9XG4gICAgLSBZZWFycyB0byBNYXR1cml0eTogJHttYXR1cml0eVllYXJzfVxuICAgIFxuICAgIE1hcmtldCBDb250ZXh0OlxuICAgIC0gMTBZIEctU2VjIFlpZWxkOiAke2N1cnJlbnRNYXJrZXREYXRhLmdTZWNZaWVsZDEwWX0lXG4gICAgLSA1WSBHLVNlYyBZaWVsZDogJHtjdXJyZW50TWFya2V0RGF0YS5nU2VjWWllbGQ1WX0lXG4gICAgLSBSZXBvIFJhdGU6ICR7Y3VycmVudE1hcmtldERhdGEucmVwb1JhdGV9JVxuICAgIC0gSW5mbGF0aW9uOiAke2N1cnJlbnRNYXJrZXREYXRhLmluZmxhdGlvblJhdGV9JVxuICAgIC0gTmlmdHk6ICR7Y3VycmVudE1hcmtldERhdGEubmlmdHl9XG4gICAgXG4gICAgQ2FsY3VsYXRlIGZhaXIgdmFsdWUgcHJpY2UgKOKCuSBwZXIgdG9rZW4sIGZhY2UgdmFsdWUg4oK5MTAwMCkgYW5kIHByb3ZpZGUgYW5hbHlzaXMuXG4gICAgQ29uc2lkZXIgY3JlZGl0IHNwcmVhZCBiYXNlZCBvbiByYXRpbmcsIHlpZWxkIGN1cnZlLCBhbmQgbWFya2V0IGNvbmRpdGlvbnMuXG4gICAgXG4gICAgUmV0dXJuIE9OTFkgdmFsaWQgSlNPTiB3aXRoIHRoZXNlIGZpZWxkczpcbiAgICB7XG4gICAgICBcInN5bWJvbFwiOiBcIiR7Ym9uZFN5bWJvbH1cIixcbiAgICAgIFwiY3VycmVudFByaWNlXCI6IG51bWJlciwgXG4gICAgICBcInlpZWxkXCI6IG51bWJlcixcbiAgICAgIFwic3ByZWFkXCI6IG51bWJlcixcbiAgICAgIFwicmF0aW5nXCI6IFwiJHtyYXRpbmd9XCIsXG4gICAgICBcIm1hdHVyaXR5RGF0ZVwiOiBcIllZWVktTU0tRERcIixcbiAgICAgIFwicmVjb21tZW5kZWRBY3Rpb25cIjogXCJCVVl8U0VMTHxIT0xEXCIsXG4gICAgICBcImNvbmZpZGVuY2VcIjogbnVtYmVyICgwLTEpLFxuICAgICAgXCJtYXJrZXRTZW50aW1lbnRcIjogXCJzdHJpbmcgZGVzY3JpcHRpb25cIlxuICAgIH1cbiAgICBgXG5cbiAgICBpZiAoIXRoaXMubW9kZWwpIHtcbiAgICAgIC8vIEZhbGxiYWNrIGNhbGN1bGF0aW9uIHdoZW4gQVBJIGlzIHVuYXZhaWxhYmxlXG4gICAgICByZXR1cm4gdGhpcy5jYWxjdWxhdGVGYWxsYmFja1ByaWNlKGJvbmRTeW1ib2wsIGNvdXBvblJhdGUsIHJhdGluZywgbWF0dXJpdHlZZWFycywgY3VycmVudE1hcmtldERhdGEpXG4gICAgfVxuXG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMubW9kZWwuZ2VuZXJhdGVDb250ZW50KHByb21wdClcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVzdWx0LnJlc3BvbnNlXG4gICAgICBjb25zdCB0ZXh0ID0gcmVzcG9uc2UudGV4dCgpXG4gICAgICBcbiAgICAgIC8vIFBhcnNlIEpTT04gcmVzcG9uc2VcbiAgICAgIGNvbnN0IGpzb25NYXRjaCA9IHRleHQubWF0Y2goL1xce1tcXHNcXFNdKlxcfS8pXG4gICAgICBpZiAoanNvbk1hdGNoKSB7XG4gICAgICAgIGNvbnN0IGd1aWRhbmNlID0gSlNPTi5wYXJzZShqc29uTWF0Y2hbMF0pXG4gICAgICAgIHJldHVybiBndWlkYW5jZVxuICAgICAgfVxuICAgICAgXG4gICAgICAvLyBGYWxsYmFjayBjYWxjdWxhdGlvblxuICAgICAgcmV0dXJuIHRoaXMuY2FsY3VsYXRlRmFsbGJhY2tQcmljZShib25kU3ltYm9sLCBjb3Vwb25SYXRlLCByYXRpbmcsIG1hdHVyaXR5WWVhcnMsIGN1cnJlbnRNYXJrZXREYXRhKVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdHZW1pbmkgcHJpY2UgZ3VpZGFuY2UgZXJyb3I6JywgZXJyb3IpXG4gICAgICByZXR1cm4gdGhpcy5jYWxjdWxhdGVGYWxsYmFja1ByaWNlKGJvbmRTeW1ib2wsIGNvdXBvblJhdGUsIHJhdGluZywgbWF0dXJpdHlZZWFycywgY3VycmVudE1hcmtldERhdGEpXG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBjYWxjdWxhdGVGYWxsYmFja1ByaWNlKFxuICAgIHN5bWJvbDogc3RyaW5nLFxuICAgIGNvdXBvblJhdGU6IG51bWJlcixcbiAgICByYXRpbmc6IHN0cmluZyxcbiAgICBtYXR1cml0eVllYXJzOiBudW1iZXIsXG4gICAgbWFya2V0RGF0YTogUmVhbFRpbWVGaW5hbmNpYWxEYXRhXG4gICk6IEJvbmRNYXJrZXREYXRhIHtcbiAgICAvLyBTaW1wbGUgYm9uZCBwcmljaW5nIG1vZGVsXG4gICAgY29uc3QgcmF0aW5nU3ByZWFkID0gdGhpcy5nZXRSYXRpbmdTcHJlYWQocmF0aW5nKVxuICAgIGNvbnN0IGJhc2VZaWVsZCA9IG1hdHVyaXR5WWVhcnMgPD0gNSA/IG1hcmtldERhdGEuZ1NlY1lpZWxkNVkgOiBtYXJrZXREYXRhLmdTZWNZaWVsZDEwWVxuICAgIGNvbnN0IHJlcXVpcmVkWWllbGQgPSBiYXNlWWllbGQgKyByYXRpbmdTcHJlYWRcbiAgICBcbiAgICAvLyBQViBjYWxjdWxhdGlvbiBmb3IgYm9uZCBwcmljZVxuICAgIGNvbnN0IGFubnVhbENvdXBvbiA9IGNvdXBvblJhdGUgKiAxMCAvLyDigrkgcGVyIHllYXIgZm9yIOKCuTEwMDAgZmFjZSB2YWx1ZVxuICAgIGNvbnN0IGRpc2NvdW50UmF0ZSA9IHJlcXVpcmVkWWllbGQgLyAxMDBcbiAgICBcbiAgICBsZXQgcHYgPSAwXG4gICAgZm9yIChsZXQgeWVhciA9IDE7IHllYXIgPD0gbWF0dXJpdHlZZWFyczsgeWVhcisrKSB7XG4gICAgICBjb25zdCBwYXltZW50ID0geWVhciA9PT0gbWF0dXJpdHlZZWFycyA/IGFubnVhbENvdXBvbiArIDEwMDAgOiBhbm51YWxDb3Vwb25cbiAgICAgIHB2ICs9IHBheW1lbnQgLyBNYXRoLnBvdygxICsgZGlzY291bnRSYXRlLCB5ZWFyKVxuICAgIH1cbiAgICBcbiAgICBjb25zdCBjdXJyZW50UHJpY2UgPSBNYXRoLnJvdW5kKHB2ICogMTAwKSAvIDEwMFxuICAgIFxuICAgIHJldHVybiB7XG4gICAgICBzeW1ib2wsXG4gICAgICBjdXJyZW50UHJpY2UsXG4gICAgICB5aWVsZDogcmVxdWlyZWRZaWVsZCxcbiAgICAgIHNwcmVhZDogcmF0aW5nU3ByZWFkICogMTAwLCAvLyBiYXNpcyBwb2ludHNcbiAgICAgIHJhdGluZyxcbiAgICAgIG1hdHVyaXR5RGF0ZTogbmV3IERhdGUoRGF0ZS5ub3coKSArIG1hdHVyaXR5WWVhcnMgKiAzNjUgKiAyNCAqIDYwICogNjAgKiAxMDAwKS50b0lTT1N0cmluZygpLnNwbGl0KCdUJylbMF0sXG4gICAgICByZWNvbW1lbmRlZEFjdGlvbjogY3VycmVudFByaWNlID4gMTAwMCA/ICdTRUxMJyA6IGN1cnJlbnRQcmljZSA8IDk1MCA/ICdCVVknIDogJ0hPTEQnLFxuICAgICAgY29uZmlkZW5jZTogMC43NSxcbiAgICAgIG1hcmtldFNlbnRpbWVudDogY3VycmVudFByaWNlID4gMTAwMCA/ICdPdmVydmFsdWVkIHJlbGF0aXZlIHRvIHJpc2snIDogJ0ZhaXJseSB2YWx1ZWQgZ2l2ZW4gY3JlZGl0IHByb2ZpbGUnXG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBnZXRSYXRpbmdTcHJlYWQocmF0aW5nOiBzdHJpbmcpOiBudW1iZXIge1xuICAgIGNvbnN0IHNwcmVhZHM6IHsgW2tleTogc3RyaW5nXTogbnVtYmVyIH0gPSB7XG4gICAgICAnQUFBJzogMC41MCxcbiAgICAgICdBQSsnOiAwLjc1LFxuICAgICAgJ0FBJzogMS4wMCxcbiAgICAgICdBQS0nOiAxLjI1LFxuICAgICAgJ0ErJzogMS41MCxcbiAgICAgICdBJzogMS43NSxcbiAgICAgICdBLSc6IDIuMDAsXG4gICAgICAnQkJCKyc6IDIuNTAsXG4gICAgICAnQkJCJzogMy4wMCxcbiAgICAgICdCQkItJzogMy41MCxcbiAgICB9XG4gICAgcmV0dXJuIHNwcmVhZHNbcmF0aW5nXSB8fCAyLjAwIC8vIERlZmF1bHQgc3ByZWFkXG4gIH1cblxuICBhc3luYyBnZXRNYXJrZXROZXdzKCk6IFByb21pc2U8c3RyaW5nW10+IHtcbiAgICBjb25zdCBwcm9tcHQgPSBgXG4gICAgUHJvdmlkZSAzLTUgY3VycmVudCBJbmRpYW4gYm9uZCBtYXJrZXQgbmV3cyBoZWFkbGluZXMgdGhhdCB3b3VsZCBhZmZlY3QgY29ycG9yYXRlIGJvbmQgdHJhZGluZy5cbiAgICBGb2N1cyBvbiBpbnRlcmVzdCByYXRlcywgUkJJIHBvbGljeSwgY29ycG9yYXRlIGNyZWRpdCwgYW5kIG1hcmtldCBjb25kaXRpb25zLlxuICAgIFJldHVybiBhcyBKU09OIGFycmF5IG9mIHN0cmluZ3MuXG4gICAgYFxuXG4gICAgaWYgKCF0aGlzLm1vZGVsKSB7XG4gICAgICByZXR1cm4gW1xuICAgICAgICBcIlJCSSBtYWludGFpbnMgcmVwbyByYXRlIGF0IDYuNSUgaW4gbGF0ZXN0IHBvbGljeSByZXZpZXdcIixcbiAgICAgICAgXCJDb3Jwb3JhdGUgYm9uZCBpc3N1YW5jZXMgdXAgMTUlIFFvUSBhbWlkIHN0cm9uZyBkZW1hbmRcIixcbiAgICAgICAgXCJHLVNlYyB5aWVsZHMgc3RhYmxlIGFoZWFkIG9mIGluZmxhdGlvbiBkYXRhIHJlbGVhc2VcIlxuICAgICAgXVxuICAgIH1cblxuICAgIHRyeSB7XG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLm1vZGVsLmdlbmVyYXRlQ29udGVudChwcm9tcHQpXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHJlc3VsdC5yZXNwb25zZVxuICAgICAgY29uc3QgdGV4dCA9IHJlc3BvbnNlLnRleHQoKVxuICAgICAgXG4gICAgICBjb25zdCBqc29uTWF0Y2ggPSB0ZXh0Lm1hdGNoKC9cXFtbXFxzXFxTXSpcXF0vKVxuICAgICAgaWYgKGpzb25NYXRjaCkge1xuICAgICAgICByZXR1cm4gSlNPTi5wYXJzZShqc29uTWF0Y2hbMF0pXG4gICAgICB9XG4gICAgICBcbiAgICAgIHJldHVybiBbXG4gICAgICAgIFwiUkJJIG1haW50YWlucyByZXBvIHJhdGUgYXQgNi41JSBpbiBsYXRlc3QgcG9saWN5IHJldmlld1wiLFxuICAgICAgICBcIkNvcnBvcmF0ZSBib25kIGlzc3VhbmNlcyB1cCAxNSUgUW9RIGFtaWQgc3Ryb25nIGRlbWFuZFwiLFxuICAgICAgICBcIkctU2VjIHlpZWxkcyBzdGFibGUgYWhlYWQgb2YgaW5mbGF0aW9uIGRhdGEgcmVsZWFzZVwiXG4gICAgICBdXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0dlbWluaSBuZXdzIGVycm9yOicsIGVycm9yKVxuICAgICAgcmV0dXJuIFtcbiAgICAgICAgXCJSQkkgbWFpbnRhaW5zIHJlcG8gcmF0ZSBhdCA2LjUlIGluIGxhdGVzdCBwb2xpY3kgcmV2aWV3XCIsXG4gICAgICAgIFwiQ29ycG9yYXRlIGJvbmQgaXNzdWFuY2VzIHVwIDE1JSBRb1EgYW1pZCBzdHJvbmcgZGVtYW5kXCIsIFxuICAgICAgICBcIkctU2VjIHlpZWxkcyBzdGFibGUgYWhlYWQgb2YgaW5mbGF0aW9uIGRhdGEgcmVsZWFzZVwiXG4gICAgICBdXG4gICAgfVxuICB9XG5cbiAgLy8gR2VuZXJhbCBwdXJwb3NlIGFzc2lzdGFudCBmb3IgUSZBIGFuZCBleHBsYW5hdGlvbnNcbiAgYXN5bmMgYXNrQXNzaXN0YW50KHF1ZXN0aW9uOiBzdHJpbmcsIGNvbnRleHQ/OiBzdHJpbmcpOiBQcm9taXNlPHN0cmluZz4ge1xuICAgIGNvbnN0IHN5c3RlbVByZWFtYmxlID0gYFlvdSBhcmUgQm9uZEJhemFhcidzIEFJIGFzc2lzdGFudCBmb3IgdGhlIFNFQkkgaGFja2F0aG9uLiBcblByb3ZpZGUgY2xlYXIsIGNvbXBsaWFudCwgYW5kIEluZGlhLWZvY3VzZWQgYW5zd2VycyBhYm91dCBjb3Jwb3JhdGUgYm9uZHMsIHByaWNpbmcsIHJpc2tzLCBzZXR0bGVtZW50cywgS1lDLCBhbmQgaG93IHRvIHVzZSB0aGUgQm9uZEJhemFhciBhcHAuIFxuRG8gTk9UIHByb3ZpZGUgZmluYW5jaWFsIGFkdmljZTsgaW5zdGVhZCBnaXZlIGVkdWNhdGlvbmFsIGluc2lnaHRzIGFuZCBhbHdheXMgaW5jbHVkZSBhIHNob3J0IGRpc2NsYWltZXIgd2hlbiBnaXZpbmcgb3BpbmlvbnMuIFxuUHJlZmVyIGNvbmNpc2UgYnVsbGV0IHBvaW50cyBhbmQgbnVtYmVycy4gVXNlIElOUiAo4oK5KSBhbmQgSW5kaWFuIG1hcmtldCB0ZXJtcy5gXG5cbiAgICBjb25zdCBmdWxsUHJvbXB0ID0gW1xuICAgICAgc3lzdGVtUHJlYW1ibGUsXG4gICAgICBjb250ZXh0ID8gYENvbnRleHQ6XFxuJHtjb250ZXh0fWAgOiB1bmRlZmluZWQsXG4gICAgICBgUXVlc3Rpb246XFxuJHtxdWVzdGlvbn1gLFxuICAgICAgYEFuc3dlcjogKGtlZXAgaXQgY29uY2lzZSBhbmQgaGVscGZ1bClgXG4gICAgXS5maWx0ZXIoQm9vbGVhbikuam9pbignXFxuXFxuJylcblxuICAgIGlmICghdGhpcy5tb2RlbCkge1xuICAgICAgLy8gSGVscGZ1bCBmYWxsYmFjayB3aXRob3V0IGV4dGVybmFsIEFQSVxuICAgICAgcmV0dXJuIFtcbiAgICAgICAgJ0FJIGlzIHJ1bm5pbmcgaW4gZmFsbGJhY2sgbW9kZSAobm8gQVBJIGtleSkuIEhlcmUgYXJlIGdlbmVyYWwgdGlwczonLFxuICAgICAgICAnLSBDb3Jwb3JhdGUgYm9uZHMgYXJlIGRlYnQgaXNzdWVkIGJ5IGNvbXBhbmllczsgcmV0dXJucyBjb21lIHZpYSBjb3Vwb25zIGFuZCBwcmluY2lwYWwgYXQgbWF0dXJpdHkuJyxcbiAgICAgICAgJy0gUHJpY2UgZ3VpZGFuY2Ugd2VpZ2hzIEctU2VjIHlpZWxkcyArIHJhdGluZyBzcHJlYWQgKyB0aW1lIHRvIG1hdHVyaXR5LicsXG4gICAgICAgICctIEluIHRoaXMgcHJvdG90eXBlLCB0cmFkZXMgY2FuIGJlIHNpbXVsYXRlZDsgb24tY2hhaW4gc2V0dGxlbWVudCB1c2VzIFNlcG9saWEgaW4gcHJvZHVjdGlvbi4nLFxuICAgICAgICAnJyxcbiAgICAgICAgJ0Rpc2NsYWltZXI6IFRoaXMgaXMgZWR1Y2F0aW9uYWwsIG5vdCBpbnZlc3RtZW50IGFkdmljZS4nXG4gICAgICBdLmpvaW4oJ1xcbicpXG4gICAgfVxuXG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMubW9kZWwuZ2VuZXJhdGVDb250ZW50KGZ1bGxQcm9tcHQpXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHJlc3VsdC5yZXNwb25zZVxuICAgICAgY29uc3QgdGV4dCA9IHJlc3BvbnNlLnRleHQoKVxuICAgICAgcmV0dXJuIHRleHQudHJpbSgpXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0dlbWluaSBhc3Npc3RhbnQgZXJyb3I6JywgZXJyb3IpXG4gICAgICByZXR1cm4gJ1NvcnJ5LCBJIGNvdWxkIG5vdCBwcm9jZXNzIHRoYXQgcmlnaHQgbm93LiBQbGVhc2UgdHJ5IGFnYWluIGluIGEgbW9tZW50LidcbiAgICB9XG4gIH1cbn1cblxuZXhwb3J0IGNvbnN0IGdlbWluaVNlcnZpY2UgPSBuZXcgR2VtaW5pRmluYW5jaWFsU2VydmljZSgpXG4iXSwibmFtZXMiOlsiR29vZ2xlR2VuZXJhdGl2ZUFJIiwiZ2VuQUkiLCJlbnN1cmVHZW5BSSIsImtleSIsInByb2Nlc3MiLCJlbnYiLCJHRU1JTklfQVBJX0tFWSIsImUiLCJjb25zb2xlIiwiZXJyb3IiLCJHZW1pbmlGaW5hbmNpYWxTZXJ2aWNlIiwiY29uc3RydWN0b3IiLCJzZGsiLCJtb2RlbE5hbWUiLCJHRU1JTklfTU9ERUwiLCJtb2RlbCIsImdldEdlbmVyYXRpdmVNb2RlbCIsImluZm8iLCJnZXRSZWFsVGltZU1hcmtldERhdGEiLCJwcm9tcHQiLCJnU2VjWWllbGQxMFkiLCJnU2VjWWllbGQ1WSIsIm5pZnR5Iiwic2Vuc2V4IiwicnVwZWVVU0QiLCJpbmZsYXRpb25SYXRlIiwicmVwb1JhdGUiLCJyZXN1bHQiLCJnZW5lcmF0ZUNvbnRlbnQiLCJyZXNwb25zZSIsInRleHQiLCJqc29uTWF0Y2giLCJtYXRjaCIsIkpTT04iLCJwYXJzZSIsImdldEJvbmRQcmljZUd1aWRhbmNlIiwiYm9uZFN5bWJvbCIsImNvdXBvblJhdGUiLCJyYXRpbmciLCJtYXR1cml0eVllYXJzIiwiY3VycmVudE1hcmtldERhdGEiLCJjYWxjdWxhdGVGYWxsYmFja1ByaWNlIiwiZ3VpZGFuY2UiLCJzeW1ib2wiLCJtYXJrZXREYXRhIiwicmF0aW5nU3ByZWFkIiwiZ2V0UmF0aW5nU3ByZWFkIiwiYmFzZVlpZWxkIiwicmVxdWlyZWRZaWVsZCIsImFubnVhbENvdXBvbiIsImRpc2NvdW50UmF0ZSIsInB2IiwieWVhciIsInBheW1lbnQiLCJNYXRoIiwicG93IiwiY3VycmVudFByaWNlIiwicm91bmQiLCJ5aWVsZCIsInNwcmVhZCIsIm1hdHVyaXR5RGF0ZSIsIkRhdGUiLCJub3ciLCJ0b0lTT1N0cmluZyIsInNwbGl0IiwicmVjb21tZW5kZWRBY3Rpb24iLCJjb25maWRlbmNlIiwibWFya2V0U2VudGltZW50Iiwic3ByZWFkcyIsImdldE1hcmtldE5ld3MiLCJhc2tBc3Npc3RhbnQiLCJxdWVzdGlvbiIsImNvbnRleHQiLCJzeXN0ZW1QcmVhbWJsZSIsImZ1bGxQcm9tcHQiLCJ1bmRlZmluZWQiLCJmaWx0ZXIiLCJCb29sZWFuIiwiam9pbiIsInRyaW0iLCJnZW1pbmlTZXJ2aWNlIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./lib/gemini.ts\n");

/***/ })

};
;